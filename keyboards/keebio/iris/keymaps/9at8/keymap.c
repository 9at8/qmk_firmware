#include QMK_KEYBOARD_H

#define _QWERTY 0
#define _STEERING 1
#define _MAC 2
#define _LOWER 3
#define _RAISE 4
#define _MAC_RAISE 5
#define _FN 6
#define _ADJUST 7

enum keycodes {
    QWERTY = SAFE_RANGE,

    MAC_RS,

    WD_L,
    WD_R,

    MAC_WD_L,
    MAC_WD_R,
};

#define MAC TG(_MAC)
#define LW_ENT LT(_LOWER, KC_ENT)
#define RAISE MO(_RAISE)
#define FN MO(_FN)
#define RSFT_ENT RSFT_T(KC_ENT)

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

    /* Qwerty
     * .-----------------------------------------.                                     .-----------------------------------------.
     * |  `   |   1  |   2  |   3  |   4  |   5  |                                     |   6  |   7  |   8  |   9  |   0  |  Del |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * | Tab  |   Q  |   W  |   E  |   R  |   T  |                                     |   Y  |   U  |   I  |   O  |   P  | Bspc |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |Shift |   A  |   S  |   D  |   F  |   G  |                                '++' |   H  |   J  |   K  |   L  |   ;  |   '  |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * | Esc  |   Z  |   X  |   C  |   V  |   B  |  Fn  |                       | MsWhl|   N  |   M  |   ,  |   .  |   /  | Shift|
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          | Alt  | Ctrl |LW+Ent|                             | Spc  | RAI  | Gui  |
     *                          '--------------------'                             '--------------------'
     */

    [_QWERTY] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
            KC_GRV,  KC_1  ,  KC_2  ,  KC_3  ,  KC_4  ,  KC_5  ,                              KC_6  ,  KC_7  ,  KC_8  ,  KC_9  ,  KC_0  ,  KC_DEL,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
            KC_TAB,  KC_Q  ,  KC_W  ,  KC_E  ,  KC_R  ,  KC_T  ,                              KC_Y  ,  KC_U  ,  KC_I  ,  KC_O  ,  KC_P  , KC_BSPC,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           CTL_ESC,  KC_A  ,  KC_S  ,  KC_D  ,  KC_F  ,  KC_G  ,                              KC_H  ,  KC_J  ,  KC_K  ,  KC_L  , KC_SCLN, KC_QUOT,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
           KC_LSFT,  KC_Z  ,  KC_X  ,  KC_C  ,  KC_V  ,  KC_B  ,   FN   ,           _______,  KC_N  ,  KC_M  , KC_COMM, KC_DOT , KC_SLSH,RSFT_ENT,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
        /*                             */ KC_LALT, KC_LCTL, LW_SPC ,                    KC_SPC , RAISE  , KC_RGUI
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),

    /* Steering
     * .-----------------------------------------.                                     .-----------------------------------------.
     * |      |      |      |      |      |      |                                     |      |      |      |      |      |      |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                     |      |      |      |      |      |      |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                '++' |      |      |      |      |      |      |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * |      |      |      |      |      |      |      |                       | MsLR |      |      |      |      |      |      |
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          |      |      |      |                             |      |      |      |
     *                          '--------------------'                             '--------------------'
     */


    [_STEERING] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______, _______,           _______, _______, _______, _______, _______, _______, _______,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                          _______, _______, _______,                    _______, _______, _______
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),

    /* Lower
     * .-----------------------------------------.                                     .-----------------------------------------.
     * |   ~  |   !  |   @  |   #  |   $  |   %  |                                     |   ^  |   &  |   *  |   (  |   )  |      |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * |   `  |   1  |   2  |   3  |   4  |   5  |                                     |   6  |   7  |   8  |   9  |   0  |      |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |      |RGB_DD|RGB_HU|RGB_SA|RGB_VA|      |                                '++' |      |   -  |   =  |   [  |   ]  |   \  |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * |      |Rgb Tg|      |      |      |      |      |                       | Brght|      |      |      |      |      |      |
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          |      |      | #### |                             |      |      |      |
     *                          '--------------------'                             '--------------------'
     */

    [_LOWER] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, KC_MINS, KC_EQL , KC_LBRC, KC_RBRC, KC_BSLS,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______, _______,           _______, _______, _______, _______, _______, _______, _______,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
        /*                             */ _______, _______, _______,                    _______, _______, _______
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),

    /* Raise
     * .-----------------------------------------.                                     .-----------------------------------------.
     * |      |      |      |      |      |      |                                     |      |      | Pg U |      |      |      |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * |      |      |      |McrStp|      |      |                                     |      | WD L |  Up  | WD R |      |      |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |      |      |      |McrStr|McrPly|      |                                '++' |      | Left | Down | Rght |      |      |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * |      |      |      |      |      |      |      |                       |      |      | Home | Pg D | End  |      |      |
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          |      |      |      |                             |      | #### |      |
     *                          '--------------------'                             '--------------------'
     */

    [_RAISE] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
            KC_GRV,  KC_1  ,  KC_2  ,  KC_3  ,  KC_4  ,  KC_5  ,                              KC_6  ,  KC_7  ,  KC_8  ,  KC_9  ,  KC_0  ,  KC_DEL,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
            KC_TAB,  KC_Q  ,  KC_W  ,  KC_E  ,  KC_R  ,  KC_T  ,                              KC_Y  ,  KC_U  ,  KC_I  ,  KC_O  ,  KC_P  , KC_BSPC,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
            CTL_ESC, KC_A  ,  KC_S  ,  KC_D  ,  KC_F  ,  KC_G  ,                              KC_H  ,  KC_J  ,  KC_K  ,  KC_L  , KC_SCLN, KC_QUOT,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
            KC_LSFT, KC_Z  ,  KC_X  ,  KC_C  ,  KC_V  ,  KC_B  ,  FN1   ,          _______ ,  KC_N  ,  KC_M  , KC_COMM, KC_DOT , KC_SLSH,RSFT_ENT,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
        /*                             */ KC_LALT, KC_LCTL, LW_SPC ,                    KC_SPC , RAISE  , KC_RGUI
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),

    /* Function
     * .-----------------------------------------.                                     .-----------------------------------------.
     * |      |  F1  |  F2  |  F3  |  F4  |  F5  |                                     |  F6  |  F7  |  F8  |  F9  |  F10 |      |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                     |      |      |      |      |      |      |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                '++' |      | Prev | Play | Next |      |      |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * |      |      |      |      |      |      |      |                       |  Vol |      |      |      |      |      |      |
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          |      |      |      |                             |      |      |      |
     *                          '--------------------'                             '--------------------'
     */


    [_FN] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______, _______,           _______, _______, _______, _______, _______, _______, _______,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                          _______, _______, _______,                    _______, _______, _______
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),

    /* Adjust
     * .-----------------------------------------.                                     .-----------------------------------------.
     * | RESET| DEBUG|      |      |      |      |                                     |      |      |      |      |      |      |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                     |      |      |      |      |      |      |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                '++' |      | STEER|  MAC |      |      |      |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * |      |      |      |      |      |      |      |                       |      |      |      |      |      |      |      |
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          |      |      | #### |                             |      | #### |      |
     *                          '--------------------'                             '--------------------'
     */


    [_ADJUST] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______, _______,           _______, _______, _______, _______, _______, _______, _______,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                          _______, _______, _______,                    _______, _______, _______
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),
};

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
  switch (keycode) {
    case QWERTY:
      if (record->event.pressed) {
        set_single_persistent_default_layer(_QWERTY);
      }
      return false;
      break;
    case LOWER:
      if (record->event.pressed) {
        layer_on(_LOWER);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      } else {
        layer_off(_LOWER);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      }
      return false;
      break;
    case RAISE:
      if (record->event.pressed) {
        layer_on(_RAISE);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      } else {
        layer_off(_RAISE);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      }
      return false;
      break;
    case ADJUST:
      if (record->event.pressed) {
        layer_on(_ADJUST);
      } else {
        layer_off(_ADJUST);
      }
      return false;
      break;
  }
  return true;
}

void encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        if (clockwise) {
            tap_code(KC_VOLU);
        } else {
            tap_code(KC_VOLD);
        }
    }
    else if (index == 1) {
        if (clockwise) {
            tap_code(KC_PGDN);
        } else {
            tap_code(KC_PGUP);
        }
    }
}


/*

Template

    Qwerty
     * .-----------------------------------------.                                     .-----------------------------------------.
     * |  `   |   1  |   2  |   3  |   4  |   5  |                                     |   6  |   7  |   8  |   9  |   0  |  Del |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * | Tab  |   Q  |   W  |   E  |   R  |   T  |                                     |   Y  |   U  |   I  |   O  |   P  | Bspc |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |Ct+Esc|   A  |   S  |   D  |   F  |   G  |                                '++' |   H  |   J  |   K  |   L  |   ;  |   '  |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * |Shift |   Z  |   X  |   C  |   V  |   B  |  Fn1 |                       |      |   N  |   M  |   ,  |   .  |   /  |Sh+Ent|
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          | Alt  | Ctrl |LW+spc|                             | Spc  | RAI  | Gui  |
     *                          '--------------------'                             '--------------------'


    [_QWERTY] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
            KC_GRV,  KC_1  ,  KC_2  ,  KC_3  ,  KC_4  ,  KC_5  ,                              KC_6  ,  KC_7  ,  KC_8  ,  KC_9  ,  KC_0  ,  KC_DEL,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
            KC_TAB,  KC_Q  ,  KC_W  ,  KC_E  ,  KC_R  ,  KC_T  ,                              KC_Y  ,  KC_U  ,  KC_I  ,  KC_O  ,  KC_P  , KC_BSPC,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           CTL_ESC,  KC_A  ,  KC_S  ,  KC_D  ,  KC_F  ,  KC_G  ,                              KC_H  ,  KC_J  ,  KC_K  ,  KC_L  , KC_SCLN, KC_QUOT,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
           KC_LSFT,  KC_Z  ,  KC_X  ,  KC_C  ,  KC_V  ,  KC_B  ,  FN1   ,           _______,  KC_N  ,  KC_M  , KC_COMM, KC_DOT , KC_SLSH,RSFT_ENT,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                          KC_LALT, KC_LCTL, LW_SPC ,                    KC_SPC , RAISE  , KC_RGUI
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),

     Lower
     * .-----------------------------------------.                                     .-----------------------------------------.
     * |      |      |      |      |      |      |                                     |      |      |      |      |      |      |
     * |------+------+------+------+------+------|                                     |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                     |      |      |      |      |      |      |
     * |------+------+------+------+------+------|                                .==. |------+------+------+------+------+------|
     * |      |      |      |      |      |      |                                '++' |      |      |      |      |      |      |
     * |------+------+------+------+------+------+------.                       .--||--+------+------+------+------+------+------|
     * |      |      |      |      |      |      |      |                       |      |      |      |      |      |      |      |
     * '------------------------+------+------+------+--'                       '--+------+------+------+------------------------'
     *                          |      |      |      |                             |      |      |      |
     *                          '--------------------'                             '--------------------'


    [_LOWER] = LAYOUT(
        //┌───────┬────────┬────────┬────────┬────────┬────────┐                           ┌────────┬────────┬────────┬────────┬────────┬────────┐
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤                           ├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______,                             _______, _______, _______, _______, _______, _______,
        //├───────┼────────┼────────┼────────┼────────┼────────┤────────┐         ┌────────├────────┼────────┼────────┼────────┼────────┼────────┤
           _______, _______, _______, _______, _______, _______, _______,           _______, _______, _______, _______, _______, _______, _______,
        //└───────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘         └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                          _______, _______, _______,                    _______, _______, _______
        //                              └────────┴────────┴────────┘                  └────────┴────────┴────────┘
    ),

*/
